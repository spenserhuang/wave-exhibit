<!DOCTYPE html>
<html>
<head>
    <title>TopCodes Example</title>
</head>

<body>
    <canvas id="video-canvas" width="800" height="600" style="background: #ddd;"></canvas>
    <br/>
    <button id="camera-button" onclick="TopCodes.startStopVideoScan('video-canvas')">Start / Stop</button>

    <script src="../js/topcodes.js"></script>

    <script>

        // register a callback function with the TopCode library
        TopCodes.setVideoFrameCallback("video-canvas", function(jsonString) {

        // convert the JSON string to an object
        var json = JSON.parse(jsonString);

        // get the list of topcodes from the JSON object
        var topcodes = json.topcodes;

        // obtain a drawing context from the <canvas>
        var ctx = document.querySelector("#video-canvas").getContext('2d');
        var ctx2 = document.querySelector("#video-canvas").getContext('2d');


        var verticalDistance = 0;
        var horizontalDistance = 0;


        // draw a circle over the top of each TopCode
        ctx.fillStyle = "rgba(255, 0, 0, 0.3)";   // very translucent red
        for (i=0; i<topcodes.length; i++) {
            for (j=0; j<topcodes.length; j++) {
                    ctx.beginPath();
                    ctx.arc(topcodes[i].x, topcodes[i].y, topcodes[i].radius, 0, Math.PI*2, true);
                    ctx.fill();
                    if (topcodes[i].code == 55 && topcodes[j].code == 31) {
                        console.log(topcodes[j].y - topcodes[i].y);
                        verticalDistance = topcodes[j].y - topcodes[i].y;
                    }
                }
            }
        
        ctx2.fillStyle = "rgba(0, 255, 0, 0.3)";   // very translucent red
        for (i=0; i<topcodes.length; i++) {
            for (j=0; j<topcodes.length; j++) {
                    ctx2.beginPath();
                    ctx2.arc(topcodes[i].x, topcodes[i].y, topcodes[i].radius, 0, Math.PI*2, true);
                    ctx2.fill();
                    if (topcodes[i].code == 87 && topcodes[j].code == 47) {
                        console.log(topcodes[j].x - topcodes[i].x);
                        horizontalDistance = topcodes[j].x - topcodes[i].x;
                    }
                }
            }

        });
    </script>
</body>
</html>

